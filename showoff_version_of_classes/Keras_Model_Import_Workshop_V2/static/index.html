<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <title>Importing Keras Models Into DeepLearning4J</title>

  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0"/>

  

  <link rel="stylesheet" type="text/css" href=".//css/highlight/default.css"  />
  <link rel="stylesheet" type="text/css" href=".//css/mermaid-6.0.0.css" />
  <link rel="stylesheet" type="text/css" href=".//css/font-awesome-4.4.0/css/font-awesome.min.css">
  <link rel="stylesheet" type="text/css" href=".//css/jquery-ui-1.12.1.css">
  <link rel="stylesheet" type="text/css" href=".//css/showoff.css?v=0.17.2" />
  <link rel="stylesheet" type="text/css" href=".//css/zoomline-0.0.1.css">

  <script type="text/javascript" src=".//js/jquery-2.1.4.min.js"></script>

  <script type="text/javascript" src=".//js/jquery.cycle.all-2.8.0.js"></script>
  <script type="text/javascript" src=".//js/jquery.batchImageLoad-1.0.0.js"></script>
  <script type="text/javascript" src=".//js/jquery.parsequery.min-6a20f83.js"></script>
  <script type="text/javascript" src=".//js/jquery.doubletap-4ff02c5.js"></script>
  <script type="text/javascript" src=".//js/jTypeWriter-1.1.js"></script>
  <script type="text/javascript" src=".//js/bigtext-0.1.8.js"></script>
  <script type="text/javascript" src=".//js/zoomline-0.0.1.js"></script>
  <script type="text/javascript" src=".//js/highlight.pack-9.2.0.js"></script>
  <script type="text/javascript" src=".//js/mermaid-6.0.0-min.js"></script>
  <script type="text/javascript" src=".//js/jquery-ui-1.12.1.js"></script>

  <script type="text/javascript" src=".//js/coffee-script-1.1.3-pre.js"></script>

  <script type="text/javascript" src=".//js/annotations.js?v=0.17.2"></script>
  <script type="text/javascript" src=".//js/showoff.js?v=0.17.2"></script>

  
    <link rel="stylesheet" href=".//file/showoff.css" type="text/css"/>
  

  

  <script type="text/javascript">
    $(function(){
      setupPreso(false, './');
    });

    editUrl     = "";
    interactive = false;

    keymap               = {
  "space": "NEXT",
  "d": "DEBUG",
  "up": "PREV",
  "left": "PREV",
  "pageup": "PREV",
  "down": "NEXT",
  "right": "NEXT",
  "pagedown": "NEXT",
  "R": "RELOAD",
  "r": "REFRESH",
  "c": "CONTENTS",
  "t": "CONTENTS",
  "h": "HELP",
  "/": "HELP",
  "?": "HELP",
  "b": "BLANK",
  ".": "BLANK",
  "F": "FOOTER",
  "f": "FOLLOW",
  "n": "NOTES",
  "esc": "CLEAR",
  "p": "PAUSE",
  "P": "PRESHOW",
  "x": "EXECUTE",
  "f5": "EXECUTE"
};
    keycode_dictionary   = {
  "0": "\\",
  "8": "backspace",
  "9": "tab",
  "12": "num",
  "13": "enter",
  "16": "shift",
  "17": "ctrl",
  "18": "alt",
  "19": "pause",
  "20": "caps",
  "27": "esc",
  "32": "space",
  "33": "pageup",
  "34": "pagedown",
  "35": "end",
  "36": "home",
  "37": "left",
  "38": "up",
  "39": "right",
  "40": "down",
  "44": "print",
  "45": "insert",
  "46": "delete",
  "48": "0",
  "49": "1",
  "50": "2",
  "51": "3",
  "52": "4",
  "53": "5",
  "54": "6",
  "55": "7",
  "56": "8",
  "57": "9",
  "59": ";",
  "61": "=",
  "65": "a",
  "66": "b",
  "67": "c",
  "68": "d",
  "69": "e",
  "70": "f",
  "71": "g",
  "72": "h",
  "73": "i",
  "74": "j",
  "75": "k",
  "76": "l",
  "77": "m",
  "78": "n",
  "79": "o",
  "80": "p",
  "81": "q",
  "82": "r",
  "83": "s",
  "84": "t",
  "85": "u",
  "86": "v",
  "87": "w",
  "88": "x",
  "89": "y",
  "90": "z",
  "91": "cmd",
  "92": "cmd",
  "93": "cmd",
  "96": "num_0",
  "97": "num_1",
  "98": "num_2",
  "99": "num_3",
  "100": "num_4",
  "101": "num_5",
  "102": "num_6",
  "103": "num_7",
  "104": "num_8",
  "105": "num_9",
  "106": "num_multiply",
  "107": "num_add",
  "108": "num_enter",
  "109": "num_subtract",
  "110": "num_decimal",
  "111": "num_divide",
  "112": "f1",
  "113": "f2",
  "114": "f3",
  "115": "f4",
  "116": "f5",
  "117": "f6",
  "118": "f7",
  "119": "f8",
  "120": "f9",
  "121": "f10",
  "122": "f11",
  "123": "f12",
  "124": "print",
  "144": "num",
  "145": "scroll",
  "173": "-",
  "186": ";",
  "187": "=",
  "188": ",",
  "189": "-",
  "190": ".",
  "191": "/",
  "192": "`",
  "219": "[",
  "220": "\\",
  "221": "]",
  "222": "'",
  "223": "`",
  "224": "cmd",
  "225": "alt",
  "57392": "ctrl",
  "63289": "num"
};
    keycode_shifted_keys = {
  "0": ")",
  "1": "!",
  "2": "@",
  "3": "#",
  "4": "$",
  "5": "%",
  "6": "^",
  "7": "&",
  "8": "*",
  "9": "(",
  "/": "?",
  ".": ">",
  ",": "<",
  "'": "\"",
  ";": ":",
  "[": "{",
  "]": "}",
  "\\": "|",
  "`": "~",
  "=": "+",
  "-": "_"
};

  </script>

</head>

<body>
<div id="questionsIndicator"></div>

<i id="hamburger" class="fa fa-bars fa-2x"></i>
<div id="sidebarWrapper">
    <div id="navigationHover"></div>
    <div id="feedbackSidebar" class="sideMenu">
    <img id="disconnected" src=".//css/disconnected.png">
    <h3>Showoff Menu</h3>
    <div id="navToggle" class="buttonWrapper"><i class=" fa fa-bookmark"></i> Table of Contents</div>
    <div id="navigation" class="submenu"></div>
    
    <hr>

    

    <div id="closeMenu" class="buttonWrapper"><i class="fa fa-close"></i> Close</div>
    <hr>

    <small>
        <p>Press <code>?</code> for help.</p>
        <p>All features are anonymous</p>
    </small>
    </div>
    <div id="sidebarExit"></div>
</div>
<div id="help-modal" title="Help">
  <div id="help">
    <div>
      <span class="description">Move to the next slide.</span>
      <span class="action">NEXT</span>
      <span class="hotkeys"><span class="key">space</span><span class="key">down</span><span class="key">right</span><span class="key">pagedown</span></span>
    </div>
    <div>
      <span class="description">Move to the previous slide.</span>
      <span class="action">PREV</span>
      <span class="hotkeys"><span class="key">up</span><span class="key">left</span><span class="key">pageup</span></span>
    </div>
    <div>
      <span class="description">Show the table of contents menu.</span>
      <span class="action">CONTENTS</span>
      <span class="hotkeys"><span class="key">c</span><span class="key">t</span></span>
    </div>
    <div>
      <span class="description">Toggle follow mode.</span>
      <span class="action">FOLLOW</span>
      <span class="hotkeys"><span class="key">f</span></span>
    </div>
    <div>
      <span class="description">Show this help dialog.</span>
      <span class="action">HELP</span>
      <span class="hotkeys"><span class="key">h</span><span class="key">/</span><span class="key">?</span></span>
    </div>

    <hr />

    <div>
      <span class="description">Refresh slide content.</span>
      <span class="action">REFRESH</span>
      <span class="hotkeys"><span class="key">r</span></span>
    </div>
    <div>
      <span class="description">Completely reload Showoff.</span>
      <span class="action">RELOAD</span>
      <span class="hotkeys"><span class="key">R</span></span>
    </div>
    <div>
      <span class="description">Blank the screen.</span>
      <span class="action">BLANK</span>
      <span class="hotkeys"><span class="key">b</span><span class="key">.</span></span>
    </div>
    <div>
      <span class="description">Toggle the display footer.</span>
      <span class="action">FOOTER</span>
      <span class="hotkeys"><span class="key">F</span></span>
    </div>
    <div>
      <span class="description">Toggle notes display.</span>
      <span class="action">NOTES</span>
      <span class="hotkeys"><span class="key">n</span></span>
    </div>
    <div>
      <span class="description">Clear code execution results.</span>
      <span class="action">CLEAR</span>
      <span class="hotkeys"><span class="key">esc</span></span>
    </div>
    <div>
      <span class="description">Pause the presentation.</span>
      <span class="action">PAUSE</span>
      <span class="hotkeys"><span class="key">p</span></span>
    </div>
    <div>
      <span class="description">Display slideshow of <tt>preshow</tt> images on a timer.</span>
      <span class="action">PRESHOW</span>
      <span class="hotkeys"><span class="key">P</span></span>
    </div>
    <div>
      <span class="description">Execute the first visible code block.</span>
      <span class="action">EXECUTE</span>
      <span class="hotkeys"><span class="key">x</span><span class="key">f5</span></span>
    </div>

    <hr />

    <div>
      <span class="description">Show debugging information.</span>
      <span class="action">DEBUG</span>
      <span class="hotkeys"><span class="key">d</span></span>
    </div>
  </div>
</div>

<div id="preso"><center>loading presentation...</center></div>

<div id="notes"></div>

<footer id="footer">
  <span id="followMode"></span>
  <span id="slideInfo"></span>
  <span id="debugInfo"></span>
  <span id="notesInfo"></span>
  <span id="slideFilename"></span>
  <img id="disconnected" src=".//css/disconnected.png" />
</footer>

<div id="slides" class="offscreen" style="display:none;">
<div data-section="Introduction" data-title="README" id="README1" class="slide" data-transition="none">
<div class="content " ref="README:1">
<h1>Keras Model Import into DeepLearning4J</h1>

<p>Tom Hanlon</p>

<p><a href="mailto:tom@skymind.io">tom@skymind.io</a></p>

<p><strong>Schedule:</strong> </p>

<p><strong>Tonight:</strong> about 1.5 hour of slides followed by Q &amp; A</p>

<p><strong>Homework:</strong> Git Repo and Lab instructions will be shared as a PDF</p>

<!---  !SLIDE[bg=resources/skymind_c_720.png] background-fit right -->
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="Introduction" data-title="README" id="README2" class="slide" data-transition="none">
<div class="content " ref="README:2">
<h1>Getting Help</h1>

<ul>
<li>Join us on Gitter Chat

<ul>
<li><a href="https://gitter.im/deeplearning4j/deeplearning4j">https://gitter.im/deeplearning4j/deeplearning4j</a></li>
</ul>
</li>
<li>Email <a href="mailto:Tom@skymind.io">Tom@skymind.io</a>
</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="Introduction" data-title="README" id="README3" class="slide" data-transition="none">
<div class="content " ref="README:3">
<h1>Training Information</h1>

<ul>
<li>
<a href="https://skymind.ai/academy">https://skymind.ai/academy</a>

<ul>
<li>Contact us for information on training for your organization !</li>
</ul>
</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="Keras Introduction" data-title="01" id="Keras_Introduction_011" class="slide" data-transition="none">
<div class="content " ref="Keras_Introduction/01:1">
<h1>What is Keras?</h1>

<ul>
<li>High Level Python based Deep Learning Framework</li>
<li>Developed by Francois Chollet</li>
<li>Python frontend for:

<ul>
<li>Tenserflow</li>
<li>Theano</li>
</ul>
</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="Keras Introduction" data-title="01" id="Keras_Introduction_012" class="slide" data-transition="none">
<div class="content " ref="Keras_Introduction/01:2">
<h1>What are Tensorflow and Theano?</h1>

<ul>
<li>Symbolic Math Libraries</li>
<li>Define graphs of Computations</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="Keras Introduction" data-title="01" id="Keras_Introduction_013" class="slide" data-transition="none">
<div class="content " ref="Keras_Introduction/01:3">
<h1>The Process of Building a Neural Network in Keras</h1>

<ul>
<li>Data Ingestion

<ul>
<li>NumPY, pandas</li>
</ul>
</li>
<li>Neural Network Configuration

<ul>
<li>Keras model</li>
</ul>
</li>
<li>Training the Network

<ul>
<li>Keras model.fit</li>
</ul>
</li>
<li>Using the Network

<ul>
<li>Keras model.predict</li>
</ul>
</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="Keras Introduction" data-title="01" id="Keras_Introduction_014" class="slide" data-transition="none">
<div class="content " ref="Keras_Introduction/01:4">
<h1>Benefits of Keras</h1>

<ul>
<li>Python

<ul>
<li>Familiar</li>
<li>NumPY</li>
<li>Notebooks</li>
<li>Data Science</li>
</ul>
</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="Keras Introduction" data-title="01" id="Keras_Introduction_015" class="slide" data-transition="none">
<div class="content " ref="Keras_Introduction/01:5">
<h1>Challenges of Keras</h1>

<ul>
<li>Migration to an Enterprise Production Environment may be challenging</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="Keras Introduction" data-title="01" id="Keras_Introduction_016" class="slide" data-transition="none">
<div class="content " ref="Keras_Introduction/01:6">
<h1>Benefits of Python</h1>

<ul>
<li>Loosely typed</li>
<li>Rapid update cycle</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="Keras Introduction" data-title="01" id="Keras_Introduction_017" class="slide" data-transition="none">
<div class="content " ref="Keras_Introduction/01:7">
<h1>Challenges of Python</h1>

<ul>
<li>Loosely typed</li>
<li>Rapid Update cycle</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="Keras Introduction" data-title="01" id="Keras_Introduction_018" class="slide" data-transition="none">
<div class="content " ref="Keras_Introduction/01:8">
<h1>Keras Example</h1>

<ul>
<li>Classification 3 species of Iris flowers based on measurements</li>
</ul>

<p>petal length, petal width, sepal length, sepal width</p>

<pre><code>6.4,3.2,5.3,2.3,2
6.5,3.0,5.5,1.8,2
7.7,3.8,6.7,2.2,2
7.7,2.6,6.9,2.3,2
6.0,2.2,5.0,1.5,2
</code></pre>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="Keras Introduction" data-title="01" id="Keras_Introduction_019" class="slide" data-transition="none">
<div class="content " ref="Keras_Introduction/01:9">
<h1>Keras Example Continued....</h1>

<ul>
<li>FeedForward Network</li>
<li>2 hidden layers</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="Keras Introduction" data-title="01" id="Keras_Introduction_0110" class="slide" data-transition="none">
<div class="content " ref="Keras_Introduction/01:10">
<h1>Keras Example Continued....</h1>

<p>Iris Classification into 3 species based on 4 measurements</p>

<pre><code>import numpy
import pandas
from keras.models import Sequential
from keras.layers import Dense
from keras.wrappers.scikit_learn import KerasClassifier
from keras.utils import np_utils
from sklearn.cross_validation import cross_val_score, KFold
from sklearn.preprocessing import LabelEncoder
from sklearn.pipeline import Pipeline

# fix random seed for reproducibility
seed = 7
numpy.random.seed(seed)

# load dataset
dataframe = pandas.read_csv("iris.csv", header=None)
dataset = dataframe.values
X = dataset[:,0:4].astype(float)
Y = dataset[:,4]
print(X)
print(Y)
</code></pre>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="Keras Introduction" data-title="01" id="Keras_Introduction_0111" class="slide" data-transition="none">
<div class="content " ref="Keras_Introduction/01:11">
<h1>Keras Example Continued.....</h1>

<pre><code>#encode class values as integers
encoder = LabelEncoder()
encoder.fit(Y)
encoded_Y = encoder.transform(Y)


# convert integers to dummy variables (hot encoded)
dummy_y = np_utils.to_categorical(encoded_Y)
print(dummy_y)

# define baseline model
#def baseline_model(): 
# create model
model = Sequential()
model.add(Dense(4, input_dim=4, activation='relu'))
model.add(Dense(3,activation='sigmoid'))
</code></pre>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="Keras Introduction" data-title="01" id="Keras_Introduction_0112" class="slide" data-transition="none">
<div class="content " ref="Keras_Introduction/01:12">
<h1>Keras Example  Continued.....</h1>

<pre><code># Compile model
model.compile(loss='categorical_crossentropy', optimizer='adam', metrics=['accuracy'])

#    return model
#model.fit
model.fit(X, dummy_y, nb_epoch=200, batch_size=5)
prediction = model.predict(numpy.array([[4.6,3.6,1.0,0.2]]));
print(prediction);
</code></pre>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="Keras Introduction" data-title="01" id="Keras_Introduction_0113" class="slide" data-transition="none">
<div class="content " ref="Keras_Introduction/01:13">
<h1>Keras Example Continued....</h1>

<pre><code># To save just the weights
model.save_weights('/tmp/iris_model_weights')

# To save the weights and the config
# Note this is what is used for this demo
model.save('/tmp/full_iris_model')

# To save the Json config to a file
json_string = model.to_json()
text_file = open("/tmp/iris_model_json", "w")
text_file.write(json_string)
text_file.close()
</code></pre>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="Keras Introduction" data-title="01" id="Keras_Introduction_0114" class="slide" data-transition="none">
<div class="content " ref="Keras_Introduction/01:14">
<h1>Review of the Basic Keras Example</h1>

<ul>
<li>The various tasks are handled with different libraries</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="Keras Introduction" data-title="01" id="Keras_Introduction_0115" class="slide" data-transition="none">
<div class="content " ref="Keras_Introduction/01:15">
<h1>Data Ingest in Keras uses Pandas</h1>

<pre><code>dataframe = pandas.read_csv("iris.csv", header=None)
dataset = dataframe.values
X = dataset[:,0:4].astype(float)
Y = dataset[:,4]
print(X)
print(Y)
</code></pre>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="Keras Introduction" data-title="01" id="Keras_Introduction_0116" class="slide" data-transition="none">
<div class="content " ref="Keras_Introduction/01:16">
<h1>Scikit Learn</h1>

<ul>
<li>
<p>Used for Data Transform Operations</p>

<pre><code>encoder = LabelEncoder()
encoder.fit(Y)
encoded_Y = encoder.transform(Y)
</code></pre>
</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="Keras Introduction" data-title="01" id="Keras_Introduction_0117" class="slide" data-transition="none">
<div class="content " ref="Keras_Introduction/01:17">
<h1>Keras Native Tools</h1>

<ul>
<li>
<p>Build the Model</p>

<pre><code>model = Sequential()
model.add(Dense(4, input_dim=4, activation='relu'))
model.add(Dense(3,activation='sigmoid'))
</code></pre>
</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="Keras Introduction" data-title="01" id="Keras_Introduction_0118" class="slide" data-transition="none">
<div class="content " ref="Keras_Introduction/01:18">
<h1>Keras Execution Backend</h1>

<ul>
<li>DeepLearning involves large matrix operations</li>
<li>Keras leverages Theano or Tensorflow backend for execution</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="DeepLearning4J Introduction" data-title="01" id="DL4J_overview_01" class="slide" data-transition="none">
<div class="content " ref="DL4J_overview/01">
<h1>What is DeepLearning4J?</h1>

<ul>
<li>DeepLearning Framework built in Java</li>
<li>Supported by Skymind.io</li>
<li>Enterprise focus</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="DeepLearning4J Introduction" data-title="DeepLearning4J" id="DL4J_overview_DeepLearning4J1" class="slide" data-transition="none">
<div class="content " ref="DL4J_overview/DeepLearning4J:1">
<h1>DeepLearning4J Overview</h1>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="DeepLearning4J Introduction" data-title="DeepLearning4J" id="DL4J_overview_DeepLearning4J2" class="slide" data-transition="none">
<div class="content " ref="DL4J_overview/DeepLearning4J:2">
<h1>Goals of the DeepLearning4J project</h1>

<ul>
<li>Provide a Toolkit for using DeepLearning on the JVM

<ul>
<li>Enterprise users</li>
<li>Security</li>
<li>Flexibility</li>
</ul>
</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="DeepLearning4J Introduction" data-title="DeepLearning4J" id="DL4J_overview_DeepLearning4J3" class="slide" data-transition="none">
<div class="content " ref="DL4J_overview/DeepLearning4J:3">
<h1>DeepLearning4J sub-projects</h1>

<ul>
<li>DataVec

<ul>
<li>Tools for ETL</li>
</ul>
</li>
<li>ND4J

<ul>
<li>NUmeric Arrays</li>
<li>NumPY for the JVM</li>
</ul>
</li>
<li>libnd4j

<ul>
<li>Native Libraries for GPUs/CPUs</li>
</ul>
</li>
<li>DeepLearning4J

<ul>
<li>Tools to train Neural Networks</li>
</ul>
</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="DeepLearning4J Introduction" data-title="DeepLearning4J" id="DL4J_overview_DeepLearning4J4" class="slide" data-transition="none">
<div class="content " ref="DL4J_overview/DeepLearning4J:4">
<h1>Why Java?</h1>

<p><img src="./file//resources/tiobe.png" alt="alt text"></p>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="DeepLearning4J Introduction" data-title="DeepLearning4J" id="DL4J_overview_DeepLearning4J5" class="slide" data-transition="none">
<div class="content " ref="DL4J_overview/DeepLearning4J:5">
<h1>DeepLearning4J Overview</h1>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="DeepLearning4J Introduction" data-title="DeepLearning4J" id="DL4J_overview_DeepLearning4J6" class="slide" data-transition="none">
<div class="content " ref="DL4J_overview/DeepLearning4J:6">
<h1>Goals of the DeepLearning4J project</h1>

<ul>
<li>Provide a Toolkit for using DeepLearning on the JVM

<ul>
<li>Enterprise users</li>
<li>Security</li>
<li>Flexibility</li>
</ul>
</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="DeepLearning4J Introduction" data-title="DeepLearning4J" id="DL4J_overview_DeepLearning4J7" class="slide" data-transition="none">
<div class="content " ref="DL4J_overview/DeepLearning4J:7">
<h1>DeepLearning4J sub-projects</h1>

<ul>
<li>DataVec

<ul>
<li>Tools for ETL</li>
</ul>
</li>
<li>ND4J

<ul>
<li>NUmeric Arrays</li>
<li>NumPY for the JVM</li>
</ul>
</li>
<li>libnd4j

<ul>
<li>Native Libraries for GPUs/CPUs</li>
</ul>
</li>
<li>DeepLearning4J

<ul>
<li>Tools to train Neural Networks</li>
</ul>
</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="DeepLearning4J Introduction" data-title="DataVec" id="DL4J_overview_DataVec1" class="slide" data-transition="none">
<div class="content " ref="DL4J_overview/DataVec:1">
<h1>DataVec</h1>

<ul>
<li>ETL Libraries purpose built for Neural Networks

<ul>
<li>Neural networks process numeric arrays</li>
<li>Datavec helps you get from your_data =&gt; numeric array</li>
</ul>
</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="DeepLearning4J Introduction" data-title="DataVec" id="DL4J_overview_DataVec2" class="slide" data-transition="none">
<div class="content " ref="DL4J_overview/DataVec:2">
<h1>Data Sources Supported by DataVec</h1>

<ul>
<li>Log files</li>
<li>Text documents</li>
<li>Tabular data</li>
<li>Images and video</li>
<li>and more !!</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="DeepLearning4J Introduction" data-title="DataVec" id="DL4J_overview_DataVec3" class="slide" data-transition="none">
<div class="content " ref="DL4J_overview/DataVec:3">
<h1>DataVec Features</h1>

<ul>
<li>Transformation</li>
<li>Scaling</li>
<li>Shuffling</li>
<li>Joining</li>
<li>Splitting</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="DeepLearning4J Introduction" data-title="DataVec" id="DL4J_overview_DataVec4" class="slide" data-transition="none">
<div class="content " ref="DL4J_overview/DataVec:4">
<h1>Commonly Used Features</h1>

<ul>
<li>RecordReaders

<ul>
<li>Read files or input, convert to List of Writables</li>
</ul>
</li>
<li>Normalizers

<ul>
<li>Standardize, scale or normalize the data</li>
</ul>
</li>
<li>Transform Process

<ul>
<li>Join datasets, replace strings with numerics, extract labels</li>
</ul>
</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="DeepLearning4J Introduction" data-title="DataVec" id="DL4J_overview_DataVec5" class="slide" data-transition="none">
<div class="content " ref="DL4J_overview/DataVec:5">
<h1>Diagram of available ETL paths</h1>

<p><img src="./file//resources/ETL.png" alt="alt text"></p>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="DeepLearning4J Introduction" data-title="DataVec" id="DL4J_overview_DataVec6" class="slide" data-transition="none">
<div class="content " ref="DL4J_overview/DataVec:6">
<h1>DataVec Image Basic Example</h1>

<ul>
<li>Images are arrays of pixel values</li>
</ul>

<p><img src="./file//resources/big44.png" alt="alt text"></p>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="DeepLearning4J Introduction" data-title="DataVec" id="DL4J_overview_DataVec7" class="slide" data-transition="none">
<div class="content " ref="DL4J_overview/DataVec:7">
<h1>Code Example:</h1>

<ul>
<li>
<p>Load above image as INDArray</p>

<pre><code>INDArray imagematrix = loader.asMatrix(image);
System.out.println(imagematrix);
</code></pre>
</li>
<li>
<p>Output</p>

<pre><code>[[[[255.00, 255.00, 255.00, 255.00],
[255.00, 0.00, 0.00, 255.00],
[255.00, 0.00, 0.00, 255.00],
[255.00, 255.00, 255.00, 255.00]]]]
</code></pre>
</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="DeepLearning4J Introduction" data-title="DataVec" id="DL4J_overview_DataVec8" class="slide" data-transition="none">
<div class="content " ref="DL4J_overview/DataVec:8">
<h1>Code Example:</h1>

<ul>
<li>
<p>Scale values between 0 and 1</p>

<pre><code>DataNormalization scaler = new ImagePreProcessingScaler(0,1);
scaler.transform(imagematrix);
</code></pre>
</li>
<li>
<p>Output</p>

<pre><code>[[[[1.00, 1.00, 1.00, 1.00],
[1.00, 0.00, 0.00, 1.00],
[1.00, 0.00, 0.00, 1.00],
[1.00, 1.00, 1.00, 1.00]]]]
</code></pre>
</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="DeepLearning4J Introduction" data-title="DataVec" id="DL4J_overview_DataVec9" class="slide" data-transition="none">
<div class="content " ref="DL4J_overview/DataVec:9">
<h1>Manipulating Images with DataVec</h1>

<ul>
<li>
<p>Scale images to same height/width with RecordReader</p>

<ul>
<li>
<p>Used when processing data in bulk during training </p>

<p>ImageRecordReader recordReader = new ImageRecordReader(height,width,channels);</p>
</li>
</ul>
</li>
<li>
<p>Scale image to appropriate dimenstions with NativeImageLoader</p>

<ul>
<li>
<p>Used when processing a single image for inference</p>

<p>NativeImageLoader loader = new NativeImageLoader(height, width, channels); \ load and scale
INDArray image = loader.asMatrix(file); \ create INDarray
INDArray output = model.output(image);   \ get model prediction for image</p>
</li>
</ul>
</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="DeepLearning4J Introduction" data-title="DataVec" id="DL4J_overview_DataVec10" class="slide" data-transition="none">
<div class="content " ref="DL4J_overview/DataVec:10">
<h1>Image Data Set Augmentation</h1>

<ul>
<li>Create "larger" training set with OpenCV/dataVec tools

<ul>
<li>Transform</li>
<li>Crop</li>
<li>Skew</li>
</ul>
</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="DeepLearning4J Introduction" data-title="DataVec" id="DL4J_overview_DataVec11" class="slide" data-transition="none">
<div class="content " ref="DL4J_overview/DataVec:11">
<h1>Applying Labels</h1>

<ul>
<li>DataVec provides the following tools for generating Labels

<ul>
<li>ParentPathLabelGenerator</li>
<li>PathLabelGenerator</li>
</ul>
</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="DeepLearning4J Introduction" data-title="DataVec" id="DL4J_overview_DataVec12" class="slide" data-transition="none">
<div class="content " ref="DL4J_overview/DataVec:12">
<h1>Available Record Readers</h1>

<ul>
<li>Table of available record readers:

<ul>
<li><a href="https://deeplearning4j.org/etl-userguide">https://deeplearning4j.org/etl-userguide</a></li>
</ul>
</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="DeepLearning4J Introduction" data-title="DataVec" id="DL4J_overview_DataVec13" class="slide" data-transition="none">
<div class="content " ref="DL4J_overview/DataVec:13">
<h1>Code Example: Image Transform</h1>

<ul>
<li>
<p>Scale pixel values from 0-255 to 0-1</p>

<pre><code>DataNormalization scaler = new ImagePreProcessingScaler(0,1);
scaler.fit(dataIter);
dataIter.setPreProcessor(scaler);
</code></pre>
</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="DeepLearning4J Introduction" data-title="DataVec" id="DL4J_overview_DataVec14" class="slide" data-transition="none">
<div class="content " ref="DL4J_overview/DataVec:14">
<h1>Available ND4J Pre-Processors</h1>

<ul>
<li>ImagePreProcessingScaler

<ul>
<li>min max scaling default 0 + - 1</li>
</ul>
</li>
<li>NormalizerMinMaxScaler

<ul>
<li>Scale values observed min -&gt; 0, observed max -&gt; 1 </li>
</ul>
</li>
<li>NormalizerStandardize

<ul>
<li>moving column wise variance and mean</li>
<li>no need to pre-process</li>
</ul>
</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="DeepLearning4J Introduction" data-title="DataVec" id="DL4J_overview_DataVec15" class="slide" data-transition="none">
<div class="content " ref="DL4J_overview/DataVec:15">
<h1>Image Transforms</h1>

<ul>
<li>Included Libraries

<ul>
<li>JavaCV</li>
<li>OpenCV</li>
<li>ffmpeg</li>
</ul>
</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="DeepLearning4J Introduction" data-title="DataVec" id="DL4J_overview_DataVec16" class="slide" data-transition="none">
<div class="content " ref="DL4J_overview/DataVec:16">
<h1>Image pipeline Single Image to Pre-Trained Model</h1>

<p><img src="./file//resources/ETL_single_image.png" alt="alt text"></p>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="DeepLearning4J Introduction" data-title="DataVec" id="DL4J_overview_DataVec17" class="slide" data-transition="none">
<div class="content " ref="DL4J_overview/DataVec:17">
<h1>Code Example: CSV Data to INDArray</h1>

<pre><code>public class CSVExample {
private static Logger log = LoggerFactory.getLogger(CSVExample.class);

public static void main(String[] args) throws  Exception {

    //First: get the dataset using the record reader. CSVRecordReader handles loading/parsing
    int numLinesToSkip = 0;
    String delimiter = ",";
    RecordReader recordReader = new CSVRecordReader(numLinesToSkip,delimiter);
    recordReader.initialize(new FileSplit(new ClassPathResource("iris.txt").getFile()));

    //Second: the RecordReaderDataSetIterator handles conversion to DataSet objects, ready for use in neural network
    int labelIndex = 4;     //5 values in each row of the iris.txt CSV: 4 input features followed by an integer label (class) index. Labels are the 5th value (index 4) in each row
    int numClasses = 3;     //3 classes (types of iris flowers) in the iris data set. Classes have integer values 0, 1 or 2
    int batchSize = 150;    //Iris data set: 150 examples total. We are loading all of them into one DataSet (not recommended for large data sets)

    DataSetIterator iterator = new RecordReaderDataSetIterator(recordReader,batchSize,labelIndex,numClasses);
    DataSet allData = iterator.next();
</code></pre>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="DeepLearning4J Introduction" data-title="DataVec" id="DL4J_overview_DataVec18" class="slide" data-transition="none">
<div class="content " ref="DL4J_overview/DataVec:18">
<h1>DataVec Code Explained</h1>

<ul>
<li>RecordReader recordReader = new CSVRecordReader(numLinesToSkip,delimiter);

<ul>
<li>A RecordReader prepares a list of Writables</li>
<li>A Writable is an efficient Serialization format</li>
</ul>
</li>
<li>DataSetIterator iterator = new RecordReaderDataSetIterator

<ul>
<li>We are in DL4J know, with DataSetIterator</li>
<li>Builds an Iterator over the list of records</li>
</ul>
</li>
<li>DataSet allData = iterator.next();

<ul>
<li>Builds a DataSet</li>
<li>INDArray of Features, INDArray of Labels</li>
</ul>
</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="DeepLearning4J Introduction" data-title="DataVec" id="DL4J_overview_DataVec19" class="slide" data-transition="none">
<div class="content " ref="DL4J_overview/DataVec:19">
<h1>Frequently Used DataVec classes</h1>

<ul>
<li>CSVRecordReader

<ul>
<li>CSV text data</li>
</ul>
</li>
<li>ImageRecordReader

<ul>
<li>Convert image to numeric array representing pixel values</li>
</ul>
</li>
<li> JacksonRecordReader

<ul>
<li>Parses JSON records</li>
</ul>
</li>
<li>ParentPathLabelGenerator

<ul>
<li>Builds labels based on directory path</li>
</ul>
</li>
<li>Transform, Transform Process Builder, TransformProcess

<ul>
<li>Conversion tools</li>
</ul>
</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="DeepLearning4J Introduction" data-title="ND4J" id="DL4J_overview_ND4J1" class="slide" data-transition="none">
<div class="content " ref="DL4J_overview/ND4J:1">
<h1>ND4J</h1>

<ul>
<li>Provides scientific computing libraries</li>
<li>Main features

<ul>
<li>Versatile n-dimensional array object</li>
<li>Multiplatform functionality including GPUs</li>
<li>Linear algebra and signal processing functions</li>
</ul>
</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="DeepLearning4J Introduction" data-title="ND4J" id="DL4J_overview_ND4J2" class="slide" data-transition="none">
<div class="content " ref="DL4J_overview/ND4J:2">
<h1>ND4J and DeepLearning</h1>

<ul>
<li>Classes frequently Used

<ul>
<li>DataSet

<ul>
<li>Container for INDArrays of Features/Labels</li>
</ul>
</li>
<li>DataSetIterator

<ul>
<li>Build DataSet from RecordReader</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="DeepLearning4J Introduction" data-title="ND4J" id="DL4J_overview_ND4J3" class="slide" data-transition="none">
<div class="content " ref="DL4J_overview/ND4J:3">
<h1>libND4J</h1>

<ul>
<li>The C++ engine that powers ND4J

<ul>
<li>Speed</li>
<li>CPU and GPU support</li>
</ul>
</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="DeepLearning4J Introduction" data-title="iris" id="DL4J_overview_iris1" class="slide" data-transition="none">
<div class="content " ref="DL4J_overview/iris:1">
<h1>A Simple Neural Network in DeepLearning4J</h1>

<ul>
<li>
<p>Iris Data, 3 Species, 4 features</p>

<pre><code>package ai.skymind.training.demos;

import org.datavec.api.records.reader.RecordReader;
import org.datavec.api.records.reader.impl.csv.CSVRecordReader;
import org.datavec.api.split.FileSplit;
import org.datavec.api.util.ClassPathResource;
import org.deeplearning4j.datasets.datavec.RecordReaderDataSetIterator;
import org.deeplearning4j.eval.Evaluation;
import org.deeplearning4j.nn.conf.MultiLayerConfiguration;
import org.deeplearning4j.nn.conf.NeuralNetConfiguration;
import org.deeplearning4j.nn.conf.layers.DenseLayer;
import org.deeplearning4j.nn.conf.layers.OutputLayer;
import org.deeplearning4j.nn.multilayer.MultiLayerNetwork;
import org.deeplearning4j.nn.weights.WeightInit;
import org.deeplearning4j.optimize.listeners.ScoreIterationListener;
import org.nd4j.linalg.activations.Activation;
import org.nd4j.linalg.api.ndarray.INDArray;
import org.nd4j.linalg.dataset.DataSet;
</code></pre>
</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="DeepLearning4J Introduction" data-title="iris" id="DL4J_overview_iris2" class="slide" data-transition="none">
<div class="content " ref="DL4J_overview/iris:2">
<h1>A Simple Neural Network Continued.....</h1>

<pre><code>import org.nd4j.linalg.dataset.SplitTestAndTrain;
import org.nd4j.linalg.dataset.api.iterator.DataSetIterator;
import org.nd4j.linalg.dataset.api.preprocessor.DataNormalization;
import org.nd4j.linalg.dataset.api.preprocessor.NormalizerStandardize;
import org.nd4j.linalg.lossfunctions.LossFunctions;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
</code></pre>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="DeepLearning4J Introduction" data-title="iris" id="DL4J_overview_iris3" class="slide" data-transition="none">
<div class="content " ref="DL4J_overview/iris:3">
<h1>A Simple Neural Network Continued.....</h1>

<pre><code>public class IrisNoImport {

private static Logger log = LoggerFactory.getLogger(IrisNoImport.class);

public static void main(String[] args) throws  Exception {

//First: get the dataset using the record reader. 
//CSVRecordReader handles loading/parsing
int numLinesToSkip = 0;
String delimiter = ",";
RecordReader recordReader = new CSVRecordReader(numLinesToSkip,delimiter);
recordReader.initialize(new FileSplit(new ClassPathResource("iris.txt").getFile()));

//Second: the RecordReaderDataSetIterator handles conversion to 
//DataSet objects, ready for use in neural network
int labelIndex = 4;
int numClasses = 3;
int batchSize = 150;
</code></pre>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="DeepLearning4J Introduction" data-title="iris" id="DL4J_overview_iris4" class="slide" data-transition="none">
<div class="content " ref="DL4J_overview/iris:4">
<h1>A Simple Neural Network Continued.....</h1>

<pre><code>DataSetIterator iterator = new RecordReaderDataSetIterator(recordReader,batchSize,labelIndex,numClasses);
DataSet allData = iterator.next();
allData.shuffle();
SplitTestAndTrain testAndTrain = allData.splitTestAndTrain(0.65);  //Use 65% of data for training

DataSet trainingData = testAndTrain.getTrain();
DataSet testData = testAndTrain.getTest();
DataNormalization normalizer = new NormalizerStandardize();
normalizer.fit(trainingData);
normalizer.transform(trainingData);     
//Apply normalization to the training data
normalizer.transform(testData);         
</code></pre>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="DeepLearning4J Introduction" data-title="iris" id="DL4J_overview_iris5" class="slide" data-transition="none">
<div class="content " ref="DL4J_overview/iris:5">
<h1>A Simple Neural Network Continued.....</h1>

<pre><code>    final int numInputs = 4;
    int outputNum = 3;
    int iterations = 1000;
    long seed = 6;


    log.info("Build model....");
    MultiLayerConfiguration conf = new NeuralNetConfiguration.Builder()
        .seed(seed)
        .iterations(iterations)
        .activation(Activation.TANH)
        .weightInit(WeightInit.XAVIER)
        .learningRate(0.1)
        .regularization(true).l2(1e-4)
        .list()
        .layer(0, new DenseLayer.Builder().nIn(numInputs).nOut(3)
            .build())
        .layer(1, new DenseLayer.Builder().nIn(3).nOut(3)
            .build())
        .layer(2, new OutputLayer.Builder(LossFunctions.LossFunction.NEGATIVELOGLIKELIHOOD)
            .activation(Activation.SOFTMAX)
            .nIn(3).nOut(outputNum).build())
        .backprop(true).pretrain(false)
        .build();
</code></pre>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="DeepLearning4J Introduction" data-title="iris" id="DL4J_overview_iris6" class="slide" data-transition="none">
<div class="content " ref="DL4J_overview/iris:6">
<h1>A Simple Neural Network Continued.....</h1>

<pre><code>    //run the model
    MultiLayerNetwork model = new MultiLayerNetwork(conf);
    model.init();
    model.setListeners(new ScoreIterationListener(100));

    model.fit(trainingData);

    //evaluate the model on the test set
    Evaluation eval = new Evaluation(3);
    INDArray output = model.output(testData.getFeatureMatrix());
    eval.eval(testData.getLabels(), output);
    log.info(eval.stats());
    }

}
</code></pre>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="Keras and DL4J Side by Side Comparisons" data-title="01" id="Keras_DL4J_Feature_Comparison_011" class="slide" data-transition="none">
<div class="content " ref="Keras_DL4J_Feature_Comparison/01:1">
<h1>Keras to DeepLearning4J Feature Comparison</h1>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="Keras and DL4J Side by Side Comparisons" data-title="01" id="Keras_DL4J_Feature_Comparison_012" class="slide" data-transition="none">
<div class="content " ref="Keras_DL4J_Feature_Comparison/01:2">
<h1>The Steps of Defining and using a Neural Network</h1>

<ol>
<li>Describe the model</li>
<li>Build the model</li>
<li>Train the model</li>
<li>Use model for inference</li>
</ol>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="Keras and DL4J Side by Side Comparisons" data-title="01" id="Keras_DL4J_Feature_Comparison_013" class="slide" data-transition="none">
<div class="content " ref="Keras_DL4J_Feature_Comparison/01:3">
<h1>Describe the model</h1>

<ul>
<li>
<p>Keras</p>

<pre><code>model = Sequential()
model.add(Dense(4, input_dim=4, activation='relu'))
model.add(Dense(3,activation='sigmoid'))
</code></pre>
</li>
<li>
<p>DL4J</p>

<pre><code>MultiLayerConfiguration conf = new NeuralNetConfiguration.Builder()
.seed(seed)
.iterations(iterations)
.activation(Activation.TANH)
.weightInit(WeightInit.XAVIER)
.learningRate(0.1)
.regularization(true).l2(1e-4)
.list()
.layer(0, new DenseLayer.Builder().nIn(numInputs).nOut(3)
    .build())
    .layer(1, new DenseLayer.Builder().nIn(3).nOut(3)
    .build())
    .layer(2, new OutputLayer.Builder(LossFunctions.LossFunction.NEGATIVELOGLIKELIHOOD)
        .activation(Activation.SOFTMAX)
        .nIn(3).nOut(outputNum).build())
    .backprop(true).pretrain(false)
    .build();
</code></pre>
</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="Keras and DL4J Side by Side Comparisons" data-title="01" id="Keras_DL4J_Feature_Comparison_014" class="slide" data-transition="none">
<div class="content " ref="Keras_DL4J_Feature_Comparison/01:4">
<h1>Build the model</h1>

<ul>
<li>
<p>Keras</p>

<pre><code>model.compile(loss='categorical_crossentropy', optimizer='adam', metrics=['accuracy'])
</code></pre>
</li>
<li>
<p>DL4J</p>

<pre><code>MultiLayerNetwork model = new MultiLayerNetwork(conf);
model.init();
</code></pre>
</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="Keras and DL4J Side by Side Comparisons" data-title="01" id="Keras_DL4J_Feature_Comparison_015" class="slide" data-transition="none">
<div class="content " ref="Keras_DL4J_Feature_Comparison/01:5">
<h1>Train the model</h1>

<ul>
<li>
<p>Keras</p>

<pre><code>model.fit(X, dummy_y, nb_epoch=200, batch_size=5)
</code></pre>
</li>
<li>
<p>DL4J</p>

<pre><code>model.fit(trainingData);
</code></pre>
</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="Keras and DL4J Side by Side Comparisons" data-title="01" id="Keras_DL4J_Feature_Comparison_016" class="slide" data-transition="none">
<div class="content " ref="Keras_DL4J_Feature_Comparison/01:6">
<h1>Use the Model for Inference</h1>

<ul>
<li>
<p>Keras</p>

<pre><code>prediction = model.predict(numpy.array([[4.6,3.6,1.0,0.2]]));
</code></pre>
</li>
<li>
<p>DL4J</p>

<pre><code>INDArray output = model.output(myArray);
</code></pre>
</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="Keras and DL4J Side by Side Comparisons" data-title="01" id="Keras_DL4J_Feature_Comparison_017" class="slide" data-transition="none">
<div class="content " ref="Keras_DL4J_Feature_Comparison/01:7">
<h1>Keras Strengths</h1>

<ul>
<li>Wide adoption of Python by a number of communities

<ul>
<li>Data Science</li>
<li>Research</li>
<li>Academia</li>
</ul>
</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="Keras and DL4J Side by Side Comparisons" data-title="01" id="Keras_DL4J_Feature_Comparison_018" class="slide" data-transition="none">
<div class="content " ref="Keras_DL4J_Feature_Comparison/01:8">
<h1>Keras Strengths continued...</h1>

<ul>
<li>Python is replacing Java as the language taught in University</li>
<li>REPL enables Notebooks and easy sharing</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="Keras and DL4J Side by Side Comparisons" data-title="01" id="Keras_DL4J_Feature_Comparison_019" class="slide" data-transition="none">
<div class="content " ref="Keras_DL4J_Feature_Comparison/01:9">
<h1>DeepLearning4j Strengths</h1>

<ul>
<li>Java 

<ul>
<li>Wide use in traditional enterprise organizations</li>
<li>Stable and Secure</li>
</ul>
</li>
<li>Core Libraries purpose built for Neural Networks

<ul>
<li>DataVec for ETL</li>
<li>Nd4J for NDArrays, tensors, matrices</li>
<li>libnd4j for GPU/CPU native operations</li>
</ul>
</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="Keras and DL4J Side by Side Comparisons" data-title="01" id="Keras_DL4J_Feature_Comparison_0110" class="slide" data-transition="none">
<div class="content " ref="Keras_DL4J_Feature_Comparison/01:10">
<h1>Comparisons Between DeepLearning4J and Keras</h1>

<ul>
<li>The Stack

<ul>
<li>DL4J has purpose built full stack from ETL to Inference</li>
<li>Keras leverages other libraries for core functionality</li>
</ul>
</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="Keras and DL4J Side by Side Comparisons" data-title="01" id="Keras_DL4J_Feature_Comparison_0111" class="slide" data-transition="none">
<div class="content " ref="Keras_DL4J_Feature_Comparison/01:11">
<h1>Statically Typed vs Dynamically Typed</h1>

<ul>
<li>Java

<ul>
<li>Statically Typed</li>
</ul>
</li>
<li>Python

<ul>
<li>Dynamically typed</li>
</ul>
</li>
<li>Statically  typed languages catch many errors at compile time rather than runtime</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="Keras and DL4J Side by Side Comparisons" data-title="01" id="Keras_DL4J_Feature_Comparison_0112" class="slide" data-transition="none">
<div class="content " ref="Keras_DL4J_Feature_Comparison/01:12">
<h1>Distributed Training</h1>

<ul>
<li>DL4J in Java fits in well with Hadoop/Spark</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="Keras and DL4J Side by Side Comparisons" data-title="01" id="Keras_DL4J_Feature_Comparison_0113" class="slide" data-transition="none">
<div class="content " ref="Keras_DL4J_Feature_Comparison/01:13">
<h1>Security</h1>

<ul>
<li>DL4j on Spark/Hadoop

<ul>
<li>Leverages Robust Security Features</li>
<li>Kerberos, SSL</li>
</ul>
</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="Keras and DL4J Side by Side Comparisons" data-title="01" id="Keras_DL4J_Feature_Comparison_0114" class="slide" data-transition="none">
<div class="content " ref="Keras_DL4J_Feature_Comparison/01:14">
<h1>Keras and DeepLearning4J Similarities</h1>

<ul>
<li>Many similarities</li>
<li>Build Neural Networks</li>
<li>Build networks based on popular research or examples</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="Keras and DL4J Side by Side Comparisons" data-title="01" id="Keras_DL4J_Feature_Comparison_0115" class="slide" data-transition="none">
<div class="content " ref="Keras_DL4J_Feature_Comparison/01:15">
<h1>Keras and DeepLearning4J Differences</h1>

<ul>
<li>Differences</li>
<li>Keras is built on top of other modules

<ul>
<li>Tensorflow</li>
<li>Theano</li>
<li>SciPy, Numpy</li>
</ul>
</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="Keras and DL4J Side by Side Comparisons" data-title="01" id="Keras_DL4J_Feature_Comparison_0116" class="slide" data-transition="none">
<div class="content " ref="Keras_DL4J_Feature_Comparison/01:16">
<h1>Keras and DeepLearning4J Differences Continued....</h1>

<ul>
<li>Differences</li>
<li>DL4J team built almost all parts of the framework</li>
<li>ND4J custom built for INDArray operations to support Neural Networks</li>
<li>DataVec built to support data ingestion for Neural Networks</li>
<li>distributed Spark based functionality Built in</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="Keras and DL4J Side by Side Comparisons" data-title="01" id="Keras_DL4J_Feature_Comparison_0117" class="slide" data-transition="none">
<div class="content " ref="Keras_DL4J_Feature_Comparison/01:17">
<h1>Skymind Support for DeepLearning4J</h1>

<ul>
<li>DeepLearning4J is Open source Apache licensed</li>
<li>Community Input and Feedback is invited</li>
<li>Skymind can support youin your implemention and development</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="Saving Keras Models" data-title="01" id="Saving_Keras_Models_011" class="slide" data-transition="none">
<div class="content " ref="Saving_Keras_Models/01:1">
<h1>Saving Keras Models</h1>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="Saving Keras Models" data-title="01" id="Saving_Keras_Models_012" class="slide" data-transition="none">
<div class="content " ref="Saving_Keras_Models/01:2">
<h1>Saving just the Configuration</h1>

<ul>
<li>
<p>model.to_json</p>

<pre><code>json_string = model.to_json()
text_file = open("/tmp/iris_model_json", "w")
text_file.write(json_string)
text_file.close()
</code></pre>
</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="Saving Keras Models" data-title="01" id="Saving_Keras_Models_013" class="slide" data-transition="none">
<div class="content " ref="Saving_Keras_Models/01:3">
<h1>Saving Just the Weights</h1>

<ul>
<li>
<p>model.save_weights</p>

<pre><code>model.save_weights('/tmp/iris_model_weights')
</code></pre>
</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="Saving Keras Models" data-title="01" id="Saving_Keras_Models_014" class="slide" data-transition="none">
<div class="content " ref="Saving_Keras_Models/01:4">
<h1>Saving Weights and Configuration</h1>

<ul>
<li>
<p>model.save</p>

<pre><code>model.save('/tmp/full_iris_model')
</code></pre>
</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="Importing Keras Models into DL4J" data-title="01" id="Loading_Keras_Models_Into_DL4J_011" class="slide" data-transition="none">
<div class="content " ref="Loading_Keras_Models_Into_DL4J/01:1">
<h1>Loading Keras Models into DL4J</h1>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="Importing Keras Models into DL4J" data-title="01" id="Loading_Keras_Models_Into_DL4J_012" class="slide" data-transition="none">
<div class="content " ref="Loading_Keras_Models_Into_DL4J/01:2">
<h1>Keras Model Import</h1>

<ul>
<li>New Feature since 0.7.1</li>
<li>Current DL4J Release 0.8.0

<ul>
<li>Use 0.8.0 or above</li>
</ul>
</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="Importing Keras Models into DL4J" data-title="01" id="Loading_Keras_Models_Into_DL4J_013" class="slide" data-transition="none">
<div class="content " ref="Loading_Keras_Models_Into_DL4J/01:3">
<h1>Using Model Import</h1>

<ul>
<li>
<p>Add this to your pom.xml</p>

<pre><code>&lt;dependency&gt;
 &lt;groupId&gt;org.deeplearning4j&lt;/groupId&gt;
 &lt;artifactId&gt;deeplearning4j-modelimport&lt;/artifactId&gt;
 &lt;version&gt;${dl4j.version}&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>
</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="Importing Keras Models into DL4J" data-title="01" id="Loading_Keras_Models_Into_DL4J_014" class="slide" data-transition="none">
<div class="content " ref="Loading_Keras_Models_Into_DL4J/01:4">
<h1>Computation Graph or MultiLayerNetwork</h1>

<ul>
<li>Keras Sequential Model =&gt; DL4J MultiLayerNetwork</li>
<li>Keras Functional API =&gt; DL4J ComputationGraph</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="Importing Keras Models into DL4J" data-title="01" id="Loading_Keras_Models_Into_DL4J_015" class="slide" data-transition="none">
<div class="content " ref="Loading_Keras_Models_Into_DL4J/01:5">
<h1>Import Configuration Only</h1>

<ul>
<li>
<p>Sequential Model Configuration import, saved in Keras with model.to_json()</p>

<pre><code>CopyMultiLayerNetworkConfiguration modelConfig = 
KerasModelImport.importKerasSequentialConfiguration
("PATH TO YOUR JSON FILE)
</code></pre>
</li>
<li>
<p>ComputationGraph Configuration import, saved in Keras with model.to_json()</p>

<pre><code>ComputationGraphConfiguration computationGraphConfig = 
KerasModelImport.importKerasModelConfiguration
("PATH TO YOUR JSON FILE)
</code></pre>
</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="Importing Keras Models into DL4J" data-title="01" id="Loading_Keras_Models_Into_DL4J_016" class="slide" data-transition="none">
<div class="content " ref="Loading_Keras_Models_Into_DL4J/01:6">
<h1>Import Configuration and Weights</h1>

<ul>
<li>
<p>Sequential Model single file </p>

<pre><code>MultiLayerNetwork network = 
KerasModelImport.importKerasSequentialModelAndWeights
("PATH TO YOUR H5 FILE")
</code></pre>
</li>
<li>
<p>Sequential Model one file for config one file for weights</p>

<pre><code>MultiLayerNetwork network = 
KerasModelImport.importKerasSequentialModelAndWeights
("PATH TO YOUR JSON FILE","PATH TO YOUR H5 FILE")
</code></pre>
</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="Importing Keras Models into DL4J" data-title="01" id="Loading_Keras_Models_Into_DL4J_017" class="slide" data-transition="none">
<div class="content " ref="Loading_Keras_Models_Into_DL4J/01:7">
<h1>enforceTrainingConfig</h1>

<ul>
<li>Use model only for inference? 

<ul>
<li>enforceTrainingConfig=false</li>
</ul>
</li>
<li>Use model for further training

<ul>
<li> enforceTrainingConfig=false</li>
</ul>
</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="Saving and Loading DL4J Models" data-title="01" id="Saving_Models_011" class="slide" data-transition="none">
<div class="content " ref="Saving_Models/01:1">
<h1>Saving and Loading Trained Models</h1>

<ul>
<li>Saving a Model</li>
<li>Loading a Model</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="Saving and Loading DL4J Models" data-title="01" id="Saving_Models_012" class="slide" data-transition="none">
<div class="content " ref="Saving_Models/01:2">
<h1>Once model is imported into DL4J you can stay in DL4J</h1>

<ul>
<li>This section shows DL4J save and Load features</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="Saving and Loading DL4J Models" data-title="01" id="Saving_Models_013" class="slide" data-transition="none">
<div class="content " ref="Saving_Models/01:3">
<h1>Why Save a Model?</h1>

<ul>
<li>Training takes time</li>
<li>Deploy on multiple machines</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="Saving and Loading DL4J Models" data-title="01" id="Saving_Models_014" class="slide" data-transition="none">
<div class="content " ref="Saving_Models/01:4">
<h1>ModelSerializer</h1>

<ul>
<li>JavaDoc for ModelSerializer

<ul>
<li><a href="https://deeplearning4j.org/doc/index.html?org/deeplearning4j/util/ModelSerializer.html">https://deeplearning4j.org/doc/index.html?org/deeplearning4j/util/ModelSerializer.html</a></li>
</ul>
</li>
<li>writeModel Method

<ul>
<li>Writes configuration,weights and optionally the updater to file or output stream</li>
</ul>
</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="Saving and Loading DL4J Models" data-title="01" id="Saving_Models_015" class="slide" data-transition="none">
<div class="content " ref="Saving_Models/01:5">
<h1>Restoring a Model</h1>

<ul>
<li>restoreMultiLayerNetwork

<ul>
<li>Loads MultiLayerNetwork</li>
</ul>
</li>
<li>restoreComputationGraph

<ul>
<li>Loads ComputationGraph</li>
</ul>
</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="Saving and Loading DL4J Models" data-title="01" id="Saving_Models_016" class="slide" data-transition="none">
<div class="content " ref="Saving_Models/01:6">
<h1>loadUpdater</h1>

<ul>
<li>Updater is configuration needed for further training</li>
<li>Without Updater model can be used for inference only</li>
<li>With Updater model can be trained further</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="VGG-16 Image Classification Model" data-title="01" id="VGG-16_011" class="slide" data-transition="none">
<div class="content " ref="VGG-16/01:1">
<h1>VGG-16</h1>

<ul>
<li>The presenter may demonstrate VGG-16 model that was imported from Keras</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="VGG-16 Image Classification Model" data-title="01" id="VGG-16_012" class="slide" data-transition="none">
<div class="content " ref="VGG-16/01:2">
<h1>What is VGG-16</h1>

<ul>
<li>16 Layer Convolutional Network that performed well at ImageNet Challenge.</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="VGG-16 Image Classification Model" data-title="01" id="VGG-16_013" class="slide" data-transition="none">
<div class="content " ref="VGG-16/01:3">
<h1>ImageNet Challenge</h1>

<ul>
<li>Yearly Challenge for Image Classification over the ImageNet dataset</li>
<li>ImageNet Dataset

<ul>
<li>Millions of Labelled images</li>
<li>1000 possible classes</li>
</ul>
</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="VGG-16 Image Classification Model" data-title="01" id="VGG-16_014" class="slide" data-transition="none">
<div class="content " ref="VGG-16/01:4">
<h1>ImageNet Examples</h1>

<ul>
<li>An Image from ImageNet</li>
</ul>

<p><img src="./file//resources/cougar.png" alt="alt text"></p>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="VGG-16 Image Classification Model" data-title="01" id="VGG-16_015" class="slide" data-transition="none">
<div class="content " ref="VGG-16/01:5">
<h1>ImageNet Labels</h1>

<ul>
<li>Cougar 

<ul>
<li>puma</li>
<li>catamount</li>
<li>mountain lion </li>
<li>painter </li>
<li>panther </li>
<li>Felis concolor</li>
</ul>
</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="VGG-16 Image Classification Model" data-title="01" id="VGG-16_016" class="slide" data-transition="none">
<div class="content " ref="VGG-16/01:6">
<h1>VGG-16 details</h1>

<ul>
<li>Input 

<ul>
<li>224*224*3 images</li>
</ul>
</li>
<li>Output

<ul>
<li>probabilities for 1,000 class labels</li>
</ul>
</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="VGG-16 Image Classification Model" data-title="01" id="VGG-16_017" class="slide" data-transition="none">
<div class="content " ref="VGG-16/01:7">
<h1>Viewing the output</h1>

<ul>
<li>In your Lab Project see solutions/importVGG16

<ul>
<li>prints console info on output array </li>
</ul>
</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="VGG-16 Image Classification Model" data-title="01" id="VGG-16_018" class="slide" data-transition="none">
<div class="content " ref="VGG-16/01:8">
<h1>Taking VGG-16 and Creating Web Application for inference</h1>

<ul>
<li>/demos/VGG16SparkJavaWebApp</li>
<li><a href="https://deeplearning4j.org/demo-classifier-vgg16">https://deeplearning4j.org/demo-classifier-vgg16</a></li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="VGG-16 Image Classification Model" data-title="01" id="VGG-16_019" class="slide" data-transition="none">
<div class="content " ref="VGG-16/01:9">
<h1>The End</h1>

<ul>
<li>Thanks</li>
<li>Please try the Labs and learn to Bridge the gap between Python and Java !! </li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
</div>
<div id="buttonNav">
  <div id="buttonPrev"><i class="fa fa-chevron-left fa-lg"></i> Previous</div><div id="buttonNext">Next <i class="fa fa-chevron-right fa-lg"></i></div>
</div>
<div id="pauseScreen">
  PAUSED
</div>

</body>
</html>
